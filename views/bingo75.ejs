
<%- include('header'); %>

    <!-- Page Content -->
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <!-- <p class="lead">Players</p> -->
                <div class="list-group card75">
                    <a href="#" class="list-group-item">Player 1</a>
                    <a href="#" class="list-group-item">Player 2</a>
                    <a href="#" class="list-group-item">Player 3</a>
                </div>
                <div>
                   
                </div> 
            </div>
            <div class="col-md-9">
                <div class="row no-gutter table75_container">
                    <%  
                        if(Bingo.cards > 0){
                        for(var i=0; i < Bingo.cards; i++) { 
                        var newNum = Math.floor(Math.random() * 75) + 1;
                    %>
                    <div class="col-sm-3 col-lg-3 col-md-3">
                    <div class="card75">
                    <table class="table75 pattern" id="card_<%= i %>">
                        <tr>
                            <th width="20%">B</th>
                            <th width="20%">I</th>
                            <th width="20%">N</th>
                            <th width="20%">G</th>
                            <th width="20%">O</th>
                        </tr>
                        <tr>
                            <td id="card_<%= i %>_square0">&nbsp;</td>
                            <td id="card_<%= i %>_square1">&nbsp;</td>
                            <td id="card_<%= i %>_square2">&nbsp;</td>
                            <td id="card_<%= i %>_square3">&nbsp;</td>
                            <td id="card_<%= i %>_square4">&nbsp;</td>
                        </tr>
                        <tr>
                            <td id="card_<%= i %>_square5">&nbsp;</td>
                            <td id="card_<%= i %>_square6">&nbsp;</td>
                            <td id="card_<%= i %>_square7">&nbsp;</td>
                            <td id="card_<%= i %>_square8">&nbsp;</td>
                            <td id="card_<%= i %>_square9">&nbsp;</td>
                        </tr>
                        <tr>
                            <td id="card_<%= i %>_square10">&nbsp;</td>
                            <td id="card_<%= i %>_square11">&nbsp;</td>
                            <td id="card_<%= i %>_free" class="free_square">Free</td>
                            <td id="card_<%= i %>_square12">&nbsp;</td>
                            <td id="card_<%= i %>_square13">&nbsp;</td>
                        </tr>
                        <tr>
                            <td id="card_<%= i %>_square14">&nbsp;</td>
                            <td id="card_<%= i %>_square15">&nbsp;</td>
                            <td id="card_<%= i %>_square16">&nbsp;</td>
                            <td id="card_<%= i %>_square17">&nbsp;</td>
                            <td id="card_<%= i %>_square18">&nbsp;</td>
                        </tr>
                        <tr>
                            <td id="card_<%= i %>_square19">&nbsp;</td>
                            <td id="card_<%= i %>_square20">&nbsp;</td>
                            <td id="card_<%= i %>_square21">&nbsp;</td>
                            <td id="card_<%= i %>_square22">&nbsp;</td>
                            <td id="card_<%= i %>_square23">&nbsp;</td>
                        </tr>
                    </table>
                    </div>
                    </div>
                    <%      } 
                        } else {
                        for(var i=1; i < 9; i++) {
                    %>
<div class="col-md-3"><div class="card75" style="height: 130px;">Card <%= i %></div></div>
                    <%  }    } %>
                </div>
            </div>




        </div>
        <!--chat row-->
        <div class="row">
            <div class="col-md-9">
                <div id="rolling_ball" class="card75 ball-container">
                    <!-- <div class="bingoball"></div> -->
                    
                </div>
                <div class="card75 text-center" style="text-align: center">
                    <h4>Rooms: Choose cards and click on Play to enter the room. </h4>
                    <select name="cards" id="cards" style="width:100px;margin: 0 auto;" class="form-control">
                            <%  for(var j=1; j < 21; j++) {   %>
                            <option value="<%= j %>"><%= j %></option>
                            <%  }  %>
                    </select>
                </div>
                <div class="card75-old">
                    <% if(Bingo.rooms.length > 0){ 
                        for(i=0;i<Bingo.rooms.length;i++){
                    %>
                    <div class="row card75">
                        <div class="col-md-4 room-name">
                            <h5>Room : <%= Bingo.rooms[i].name %></h5></div>
                        <div class="col-md-4 room-desc">
                            <%= Bingo.rooms[i].description %>
                        </div>
                        <div class="col-md-2 room-name">
                            
                        </div>
                        <div class="col-md-2">
                            <a title="<%= Bingo.rooms[i]._id %>" class="play75 btn btn-primary pull-right">Play</a>
                        </div>
                    </div>
                    <% }  %>
                </div>
                
                <% } else { %>
                <div class="card75" style="height: 360px;">
                    <h1>Chat Container</h1>
                </div>
                <% } %>
            </div>
            <div class="col-md-3">
                <div class="card75">
                    <table class="table75-ball-counter" >
                        <tr>
                            <td width="100%" colspan="5" class="counter-ball-th">
                                <b>Balls (<span id="counter_ball">0</span>)</b>
                            </td>

                        </tr>
                        <tr>
                            <td id="counter_ball_1">1</td>
                            <td id="counter_ball_2">2</td>
                            <td id="counter_ball_3">3</td>
                            <td id="counter_ball_4">4</td>
                            <td id="counter_ball_5">5</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_6">6</td>
                            <td id="counter_ball_7">7</td>
                            <td id="counter_ball_8">8</td>
                            <td id="counter_ball_9">9</td>
                            <td id="counter_ball_10">10</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_11">11</td>
                            <td id="counter_ball_12">12</td>
                            <td id="counter_ball_13">13</td>
                            <td id="counter_ball_14">14</td>
                            <td id="counter_ball_15">15</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_16">16</td>
                            <td id="counter_ball_17">17</td>
                            <td id="counter_ball_18">18</td>
                            <td id="counter_ball_19">19</td>
                            <td id="counter_ball_20">20</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_21">21</td>
                            <td id="counter_ball_22">22</td>
                            <td id="counter_ball_23">23</td>
                            <td id="counter_ball_24">24</td>
                            <td id="counter_ball_25">25</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_26">26</td>
                            <td id="counter_ball_27">27</td>
                            <td id="counter_ball_28">28</td>
                            <td id="counter_ball_29">29</td>
                            <td id="counter_ball_30">30</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_31">31</td>
                            <td id="counter_ball_32">32</td>
                            <td id="counter_ball_33">33</td>
                            <td id="counter_ball_34">34</td>
                            <td id="counter_ball_35">35</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_36">36</td>
                            <td id="counter_ball_37">37</td>
                            <td id="counter_ball_38">38</td>
                            <td id="counter_ball_39">39</td>
                            <td id="counter_ball_40">40</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_41">41</td>
                            <td id="counter_ball_42">42</td>
                            <td id="counter_ball_43">43</td>
                            <td id="counter_ball_44">44</td>
                            <td id="counter_ball_45">45</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_46">46</td>
                            <td id="counter_ball_47">47</td>
                            <td id="counter_ball_48">48</td>
                            <td id="counter_ball_49">49</td>
                            <td id="counter_ball_50">50</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_51">51</td>
                            <td id="counter_ball_52">52</td>
                            <td id="counter_ball_53">53</td>
                            <td id="counter_ball_54">54</td>
                            <td id="counter_ball_55">55</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_56">56</td>
                            <td id="counter_ball_57">57</td>
                            <td id="counter_ball_58">58</td>
                            <td id="counter_ball_59">59</td>
                            <td id="counter_ball_60">60</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_61">61</td>
                            <td id="counter_ball_62">62</td>
                            <td id="counter_ball_63">63</td>
                            <td id="counter_ball_64">64</td>
                            <td id="counter_ball_65">65</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_66">66</td>
                            <td id="counter_ball_67">67</td>
                            <td id="counter_ball_68">68</td>
                            <td id="counter_ball_69">69</td>
                            <td id="counter_ball_70">70</td>
                        </tr>
                        <tr>
                            <td id="counter_ball_71">71</td>
                            <td id="counter_ball_72">72</td>
                            <td id="counter_ball_73">73</td>
                            <td id="counter_ball_74">74</td>
                            <td id="counter_ball_75">75</td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>

    </div>
    <!-- /.container -->

   <%- include('footer'); %>

<script type="text/javascript">
$( document ).ready(function() {
    $('.play75').on('click', function(e){ 
        var room = e.target.title;
        var card = $('#cards').val();
        window.location = '/bingo75?cards='+card+'&room='+room;
    })
    <% if(Bingo.cards > 0){ %>
        var num = <%= Bingo.cards %>;
        $('#btn_tick').attr('disabled','disabled');
        var pattern = ['T','I','Z','ArrowBottom','ArrowTop'];
        var selected_pattern = pattern[Math.floor(Math.random()*pattern.length)];
        bingo75 = new Bingo75(num, selected_pattern);
        bingo75.newCard();
        var array75 = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,
                       21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,
                       41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,
                       61,62,63,64,65,66,67,68,69,70,71,72,73,74,74,75];
        var cnt = 0;
        // sqr - 2 ,7, 16 21

        var stopCounter = setInterval(function(){ 

            cnt++;
           // console.log(cnt);
            var bingoballHTML = '<div class="bingoball'+cnt+'"><h3 class="ball_num'+cnt+'"></h3>                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 206.2 206.2">                          <defs>                            <style>                              .ball{isolation:isolate;}.ballcolor{fill:grey;}.cls-3{opacity:0.48;fill:url(#linear-gradient);}.cls-3,.cls-6{mix-blend-mode:screen;}.cls-4{fill:none;stroke:#fff;stroke-miterlimit:10;stroke-width:4px;}.cls-5{fill:#fff;opacity:0.8;}.cls-6{fill:url(#radial-gradient);}                            </style>                            <linearGradient id="linear-gradient" x1="103.1" x2="103.1" y2="206.2" gradientTransform="rotate(.02 114.612 114.572)" gradientUnits="userSpaceOnUse">                              <stop offset="0" stop-color="#fff"></stop>                              <stop offset="1" stop-color="#2483c5" stop-opacity="0"></stop>                            </linearGradient>                            <radialGradient id="radial-gradient" cx="72.1" cy="64.1" r="53" gradientTransform="rotate(.02 114.612 114.572)" xlink:href="#linear-gradient"></radialGradient>                          </defs>                          <g class="ball">                            <g id="Laag_1" data-name="Laag 1">                              <path d="M206.2 102.2a103 103 0 0 1-104 104C46.2 205.7.5 160 0 104A103 103 0 0 1 104 0c56 .5 101.7 46.3 102.2 102.2z" class="ballcolor'+cnt+'"></path>                              <path d="M206.2 102.2a103 103 0 0 1-104 104C46.2 205.7.5 160 0 104A103 103 0 0 1 104 0c56 .5 101.7 46.3 102.2 102.2z" class="cls-3"></path>                              <path d="M175.3 102.5A72.2 72.2 0 1 1 103.7 31a72.2 72.2 0 0 1 71.6 71.5z" class="cls-4"></path>                              <path d="M169 102.5A66 66 0 1 1 103.8 37a66 66 0 0 1 65.4 65.5z" class="cls-5"></path>                              <path d="M125 63.6A53 53 0 1 1 72.7 11 53 53 0 0 1 125 63.7z" class="cls-6"></path>                            </g>                          </g></div>';
            $('#rolling_ball').append(bingoballHTML);

            var counter_ball= array75[Math.floor(Math.random()*array75.length)];
            var index = array75.indexOf(counter_ball);
            if (index > -1) {
                array75.splice(index, 1);
            }
            //document.getElementById("card_"+i+"_square"  + j).innerHTML = newNum;
            $("#counter_ball_"  + counter_ball).addClass('red-td');
            //$('.ball_num').show();
            $('.ball_num'+cnt).html(counter_ball);
            
            //console.log(cnt);
            //console.log(array75);
            if(array75.length == 0){
                clearInterval(stopCounter);
                $('#btn_tick').removeAttr('disabled');
                return;
            }
            var colors=["blue","orange","red","green","yellow","pink","aqua","lime","purple",
                        "cyan","brown","grey","darkred","deeppink","gold","indigo"];
     
            jQuery('svg .ballcolor'+cnt).css('fill',colors[~~(Math.random()*colors.length)]);

            animate(cnt);

            bingo75.patternWinner(counter_ball);
            $("#counter_ball").html(cnt);
            if(cnt > 4){
                jQuery('#rolling_ball > div:first-of-type').remove();
                //jQuery('.bingoball'+cnt).addClass('smallball');
                //$('.bingoball'+cnt-1).css('left','650px');
                //$('.bingoball'+cnt-2).css('left','750px');
                //$('.bingoball'+cnt-3).css('left','850px');
            }

         }, 2500);
            //console.log(array75);
        function animate(cnt){
            
            var z = cnt - 1; //console.log(z);
            var y = cnt - 2;
            var x = cnt - 3;
            if(cnt == 1){
                $('.bingoball'+cnt).animate({left: '850px',opacity:'1'}, 500, animate);
            } else if(cnt == 2) {
                $('.bingoball'+cnt).animate({left: '750px',opacity:'1'}, 500, animate);
            } else if(cnt == 3) {
                $('.bingoball'+cnt).animate({left: '650px',opacity:'1'}, 500, animate);
            } else {
                $('.bingoball'+cnt).animate({left: '550px',opacity:'1'}, 500, animate);
                
                console.log(z);
                //$('.bingoball'+z).css('left:650px','-webkit-animation:inherit','animation:inherit', 'transition:inherit');
                $('.bingoball'+z).css('left','650px');
                $('.bingoball'+z).addClass('smallball');
                $('.bingoball'+y).css('left','750px');
                //$('.bingoball1').addClass('smallball');
                $('.bingoball'+x).css('left','850px');
                //$('.bingoball2').addClass('smallball');
            }
        }
        function moveBall(cnt){
            var bingoball=jQuery('.bingoball'+cnt);
            //bingoball.addClass('bingoballright');
        }
    <% } %>

});
</script>